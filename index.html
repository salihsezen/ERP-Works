<<<<<<< HEAD
<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Innobi OpsCore</title>
</head>

<body>
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
</body>

</html>
=======
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Enhanced ERP Management System</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* Dark Mode Styles */
    body.dark-mode {
      background: #1e1e2f;
      color: #eee;
    }
    body.dark-mode .tab, 
    body.dark-mode .form-area, 
    body.dark-mode .sidebar, 
    body.dark-mode .header {
      background: #2c2c3e !important;
      color: #eee !important;
    }
    body.dark-mode input, 
    body.dark-mode select, 
    body.dark-mode textarea {
      background: #444;
      color: white;
    }
    body.dark-mode th {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    }
    body.dark-mode table {
      background: #2c2c3e;
      color: #eee;
    }
    body.dark-mode td {
      border-bottom: 1px solid #444;
    }
    body.dark-mode tr:hover {
      background: rgba(102, 126, 234, 0.15);
    }
    body.dark-mode .stats-card {
      background: rgba(44, 44, 62, 0.9) !important;
      color: #eee;
    }

    /* Login Screen Styles */
    .login-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    .login-box {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      text-align: center;
    }

    .login-logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
    }

    .login-logo {
      width: 50px;
      height: 50px;
      background: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .login-logo svg {
      width: 30px;
      height: 30px;
      fill: white;
    }

    .login-logo-text {
      font-size: 24px;
      font-weight: 700;
      color: #333;
      letter-spacing: -0.5px;
    }

    .login-box h2 {
      font-size: 28px;
      margin-bottom: 30px;
      color: #333;
      font-weight: 700;
    }

    .login-input {
      width: 100%;
      padding: 15px 20px;
      margin-bottom: 20px;
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      font-size: 14px;
      transition: all 0.3s ease;
      background: white;
    }

    .login-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      transform: translateY(-1px);
    }

    .login-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      width: 100%;
      margin-top: 10px;
    }

    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .error-message {
      color: #e74c3c;
      margin-top: 15px;
      font-size: 14px;
      display: none;
    }

    /* Main App Styles (hidden initially) */
    .app-container {
      display: none;
      min-height: 100vh;
    }

    /* New app layout with sidebar */
    .app-layout {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar styles */
    .sidebar {
      width: 250px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      padding: 20px;
      display: flex;
      flex-direction: column;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .sidebar.collapsed {
      width: 70px;
    }

    .sidebar.collapsed .logo-text,
    .sidebar.collapsed .powered-by,
    .sidebar.collapsed .sidebar-nav button span {
      display: none;
    }

    .sidebar.collapsed .sidebar-logo-container {
      justify-content: center;
    }

    .sidebar.collapsed .sidebar-nav button {
      justify-content: center;
      padding: 12px;
    }

    .collapse-btn {
      position: absolute;
      bottom: 15px;
      right: 15px;
      background: rgba(102, 126, 234, 0.1);
      border: none;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .collapse-btn:hover {
      background: rgba(102, 126, 234, 0.3);
    }

    .sidebar-logo-container {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }

    .logo {
      width: 50px;
      height: 50px;
      background: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      flex-shrink: 0;
    }

    .logo svg {
      width: 30px;
      height: 30px;
      fill: white;
    }

    .logo-text {
      font-size: 24px;
      font-weight: 700;
      color: #333;
      letter-spacing: -0.5px;
      transition: all 0.3s ease;
    }

    .sidebar-nav {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .sidebar-nav button {
      padding: 12px 20px;
      text-align: left;
      border: none;
      border-radius: 10px;
      background: rgba(255,255,255,0.5);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sidebar-nav button:hover {
      background: rgba(102, 126, 234, 0.1);
    }

    .sidebar-nav button.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .main-content {
      flex: 1;
      overflow-y: auto;
      transition: all 0.3s ease;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 40px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .stats-card {
      background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      border: 1px solid rgba(255,255,255,0.3);
    }

    .stats-number {
      font-size: 32px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 5px;
    }

    .stats-label {
      font-size: 14px;
      color: #666;
      font-weight: 600;
    }

    .mobile-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* User Welcome Section - Right aligned */
    .user-welcome-container {
      display: flex;
      justify-content: flex-end;
      margin: 20px 0;
    }

    .user-welcome {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .welcome-text {
      font-size: 18px;
      font-weight: 700;
      color: #333;
    }

    .logout-btn {
      background: rgba(231, 76, 60, 0.1);
      color: #e74c3c;
      border: 2px solid #e74c3c;
      padding: 8px 20px;
      border-radius: 25px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .logout-btn:hover {
      background: #e74c3c;
      color: white;
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(231, 76, 60, 0.2);
    }

    .tab {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }

    .tab h2 {
      font-size: 28px;
      margin-bottom: 30px;
      color: #333;
      text-align: center;
      font-weight: 700;
    }

    .form-area {
      background: rgba(108, 99, 255, 0.05);
      border-radius: 15px;
      padding: 30px;
      margin: 30px 0;
      border: 1px solid rgba(108, 99, 255, 0.1);
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    input[type="text"], input[type="date"], input[type="password"],
    input[type="email"], input[type="tel"], select {
      padding: 15px 20px;
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      font-size: 14px;
      transition: all 0.3s ease;
      background: white;
      width: 100%;
    }

    input[type="text"]:focus, input[type="date"]:focus, 
    input[type="password"]:focus, input[type="email"]:focus,
    input[type="tel"]:focus, select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      transform: translateY(-1px);
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: rgba(108, 99, 255, 0.1);
      color: #6c63ff;
      border: 2px solid #6c63ff;
      padding: 12px 25px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      margin: 0 10px 10px 0;
    }

    .btn-secondary:hover {
      background: #6c63ff;
      color: white;
      transform: translateY(-1px);
    }

    .file-input-wrapper {
      position: relative;
      display: inline-block;
      margin: 10px;
    }

    .file-input-wrapper input[type=file] {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    .file-input-label {
      display: inline-block;
      padding: 12px 25px;
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
    }

    .file-input-label:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(17, 153, 142, 0.4);
    }

    .table-container {
      overflow-x: auto;
      margin-top: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 15px;
      overflow: hidden;
    }

    th {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 18px 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      position: relative;
      cursor: pointer;
      user-select: none;
    }

    th.sortable:hover {
      background: linear-gradient(135deg, #5c6bc0 0%, #6a4aa2 100%);
    }

    th span {
      margin-right: 20px;
      display: inline-block;
    }

    .sort-indicator {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 12px;
    }

    .sort-asc::after {
      content: '‚ñ≤';
      display: inline-block;
      margin-left: 5px;
    }

    .sort-desc::after {
      content: '‚ñº';
      display: inline-block;
      margin-left: 5px;
    }

    td {
      padding: 15px;
      border-bottom: 1px solid #f0f0f0;
      font-size: 14px;
    }

    tr:hover {
      background: rgba(102, 126, 234, 0.05);
    }

    th:last-child {
      width: 208px;
      text-align: center;
    }

    td:last-child {
      width: 208px;
      text-align: center;
    }

    .action-btn {
      padding: 6px 10px;
      margin: 0 2px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .action-divider {
      color: #999;
      font-weight: 300;
      margin: 0 8px;
      font-size: 14px;
      opacity: 0.6;
    }

    .edit-btn {
      background: linear-gradient(135deg, rgba(240, 147, 251, 0.6) 0%, rgba(245, 87, 108, 0.6) 100%);
      color: #333;
      border: 1px solid rgba(240, 147, 251, 0.3);
    }

    .delete-btn {
      background: linear-gradient(135deg, rgba(255, 154, 158, 0.6) 0%, rgba(254, 207, 239, 0.6) 100%);
      color: #333;
      border: 1px solid rgba(255, 154, 158, 0.3);
    }

    .action-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .hidden { 
      display: none; 
    }

    .controls-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      margin-bottom: 20px;
    }

    .powered-by {
      font-weight: normal;
      font-size: 50%;
      color: #666;
      display: block;
      margin-top: 2px;
    }

    .form-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .vendor-quick-add {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
      display: none;
    }
    
    /* Audit Log Styles */
    .audit-log {
      font-size: 12px;
      color: #666;
      margin-top: 15px;
      padding: 10px;
      border-top: 1px dashed #ddd;
    }
    
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .dashboard-card {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }
    
    .workflow-item {
      background: rgba(255, 255, 255, 0.7);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
    }
    
    .workflow-header {
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .workflow-details {
      font-size: 13px;
      color: #555;
    }

    /* Responsive styles */
    @media (max-width: 992px) {
      .sidebar {
        width: 200px;
      }
      .sidebar.collapsed {
        width: 60px;
      }
    }

    @media (max-width: 768px) {
      .app-layout {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        padding: 15px;
      }
      
      .sidebar.collapsed {
        width: 100%;
        padding: 15px;
      }
      
      .sidebar.collapsed .logo-text,
      .sidebar.collapsed .powered-by,
      .sidebar.collapsed .sidebar-nav button span {
        display: block;
      }
      
      .sidebar.collapsed .sidebar-logo-container {
        justify-content: flex-start;
      }
      
      .sidebar.collapsed .sidebar-nav button {
        justify-content: flex-start;
        padding: 12px 20px;
      }
      
      .collapse-btn {
        display: none;
      }
      
      .header {
        padding: 15px 20px;
        flex-direction: column;
        gap: 20px;
      }
      
      .tab {
        padding: 20px;
      }
      
      .form-row {
        grid-template-columns: 1fr;
      }

      .user-welcome-container {
        justify-content: center;
      }

      .user-welcome {
        flex-direction: column;
        gap: 10px;
      }
      
      .mobile-toggle {
        display: block;
      }
    }
  </style>
</head>
<body>
<!-- Login Screen -->
<div class="login-container" id="loginScreen">
  <div class="login-box">
    <div class="login-logo-container">
      <div class="login-logo">
        <svg viewbox="0 0 100 100">
          <rect fill="white" height="70" width="15" x="20" y="15"></rect>
          <rect fill="white" height="15" width="45" x="20" y="15"></rect>
          <rect fill="white" height="15" width="35" x="20" y="42.5"></rect>
          <rect fill="white" height="15" width="45" x="20" y="70"></rect>
        </svg>
      </div>
      <div class="login-logo-text">ERP System</div>
    </div>
    <h2>Login</h2>
    <input class="login-input" id="username" placeholder="Username" type="text"/>
    <input class="login-input" id="password" placeholder="Password" type="password"/>
    <button class="login-btn" onclick="login()">Login</button>
    <div class="error-message" id="errorMessage">Invalid username or password</div>
  </div>
</div>

<!-- Main Application (hidden initially) -->
<div class="app-container" id="appContainer">
  <div class="app-layout">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-logo-container">
        <div class="logo">
          <svg viewbox="0 0 100 100">
            <rect fill="white" height="70" width="15" x="20" y="15"></rect>
            <rect fill="white" height="15" width="45" x="20" y="15"></rect>
            <rect fill="white" height="15" width="35" x="20" y="42.5"></rect>
            <rect fill="white" height="15" width="45" x="20" y="70"></rect>
          </svg>
        </div>
        <div class="logo-text">ERP System<br/><span class="powered-by">Created by Salih Sezen</span></div>
      </div>
      <nav class="sidebar-nav">
        <button id="btnCustomer" class="active" onclick="showTab('customer')">üë• Customers</button>
        <button id="btnProject" onclick="showTab('project')">üìã Projects</button>
        <button id="btnVendor" onclick="showTab('vendor')">üè¢ Vendors</button>
        <button id="btnEmployee" onclick="showTab('employee')">üë®‚Äçüíº Employees</button>
        <button id="btnActual" onclick="showTab('actual')">üí∞ Actuals</button>
        <button id="btnInvoice" onclick="showTab('invoice')">üßæ Invoices</button>
        <button id="btnDashboard" onclick="showTab('dashboard')">üìä Dashboard</button>
        <button id="btnInsights" onclick="showTab('insights')">üß† AI Insights</button>
        <button id="btnWorkflow" onclick="showTab('workflow')">üìù Workflows</button>
      </nav>
      <button class="collapse-btn" id="collapseBtn" onclick="toggleSidebar()">
        <svg fill="none" height="16" viewbox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
          <path d="M15 4L7 12L15 20" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
        </svg>
      </button>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
      <div class="header">
        <div class="stats-card">
          <div class="stats-number" id="totalRecords">0</div>
          <div class="stats-label" id="recordsLabel">Total Customer Records</div>
        </div>
        <button class="mobile-toggle" onclick="toggleSidebar()">‚ò∞</button>
        <button class="btn-secondary" id="toggleDarkMode" onclick="toggleDarkMode()" style="margin-left: 20px;">
          üåô Toggle Dark Mode
        </button>
      </div>
      
      <div class="container">
        <!-- Welcome Message and Logout Button - Right aligned -->
        <div class="user-welcome-container">
          <div class="user-welcome">
            <div class="welcome-text">Welcome, Salih Sezen</div>
            <button class="logout-btn" onclick="logout()">Log Out</button>
          </div>
        </div>
        
        <section class="tab" id="customerTab">
          <div style="margin-bottom:20px;">
            <input oninput="searchCustomers(this.value)" placeholder="üîç Search customers..." style="padding:10px; width:100%; max-width:300px; border-radius:10px; border:1px solid #ccc;" type="text"/>
          </div>
          <h2>Customer Management</h2>
          <div class="form-area">
            <div class="form-row">
              <input id="customerName" placeholder="Customer Name" type="text"/>
              <input id="address" placeholder="Address" type="text"/>
              <input id="contactPerson" placeholder="Contact Person" type="text"/>
            </div>
            <button class="btn-primary" onclick="addCustomer()">‚ûï Add Customer</button>
          </div>
          <div class="controls-row">
            <button class="btn-secondary" onclick="downloadCSV(customers, ['name','address','contact'], 'Customer.csv')">‚¨áÔ∏è Download CSV</button>
            <button class="btn-secondary" onclick="exportPDF('customer')">üìÑ Export PDF</button>
            <div class="file-input-wrapper">
              <input accept=".csv" onchange="uploadCSV(event, 'customer')" type="file"/>
              <div class="file-input-label">‚¨ÜÔ∏è Upload CSV</div>
            </div>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th class="sortable" onclick="sortTable('customer', 'name')">
                    <span>Customer Name</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('customer', 'address')">
                    <span>Address</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('customer', 'contact')">
                    <span>Contact Person</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="customerList"></tbody>
            </table>
          </div>
          <div class="audit-log" id="customerLog">Last action: None</div>
        </section>
        
        <section class="tab hidden" id="projectTab">
          <div style="margin-bottom:20px;">
            <input oninput="searchProjects(this.value)" placeholder="üîç Search projects..." style="padding:10px; width:100%; max-width:300px; border-radius:10px; border:1px solid #ccc;" type="text"/>
          </div>
          <h2>Project Management</h2>
          <div class="form-area">
            <div class="form-row">
              <input id="projectNumber" placeholder="Project Number" type="text"/>
              <input id="customerNo" placeholder="Customer No" type="text"/>
              <input id="startDate" placeholder="Start Date" type="date"/>
            </div>
            <button class="btn-primary" onclick="addProject()">‚ûï Add Project</button>
          </div>
          <div class="controls-row">
            <button class="btn-secondary" onclick="downloadCSV(projects, ['number','customer','date'], 'Project.csv')">‚¨áÔ∏è Download CSV</button>
            <button class="btn-secondary" onclick="exportPDF('project')">üìÑ Export PDF</button>
            <div class="file-input-wrapper">
              <input accept=".csv" onchange="uploadCSV(event, 'project')" type="file"/>
              <div class="file-input-label">‚¨ÜÔ∏è Upload CSV</div>
            </div>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th class="sortable" onclick="sortTable('project', 'number')">
                    <span>Project Number</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('project', 'customer')">
                    <span>Customer No</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('project', 'date')">
                    <span>Start Date</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="projectList"></tbody>
            </table>
          </div>
          <div class="audit-log" id="projectLog">Last action: None</div>
        </section>
        
        <section class="tab hidden" id="vendorTab">
          <div style="margin-bottom:20px;">
            <input oninput="searchVendors(this.value)" placeholder="üîç Search vendors..." style="padding:10px; width:100%; max-width:300px; border-radius:10px; border:1px solid #ccc;" type="text"/>
          </div>
          <h2>Vendor Management</h2>
          <div class="form-area">
            <div class="form-row">
              <input id="vendorId" placeholder="Vendor ID" type="text"/>
              <input id="vendorName" placeholder="Vendor Name" type="text"/>
              <input id="vendorContact" placeholder="Contact Person" type="text"/>
            </div>
            <div class="form-row">
              <input id="vendorPhone" placeholder="Phone" type="tel"/>
              <input id="vendorEmail" placeholder="Email" type="email"/>
            </div>
            <button class="btn-primary" onclick="addVendor()">‚ûï Add Vendor</button>
          </div>
          <div class="controls-row">
            <button class="btn-secondary" onclick="downloadCSV(vendors, ['id','name','contact','phone','email'], 'Vendor.csv')">‚¨áÔ∏è Download CSV</button>
            <button class="btn-secondary" onclick="exportPDF('vendor')">üìÑ Export PDF</button>
            <div class="file-input-wrapper">
              <input accept=".csv" onchange="uploadCSV(event, 'vendor')" type="file"/>
              <div class="file-input-label">‚¨ÜÔ∏è Upload CSV</div>
            </div>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th class="sortable" onclick="sortTable('vendor', 'id')">
                    <span>Vendor ID</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('vendor', 'name')">
                    <span>Vendor Name</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('vendor', 'contact')">
                    <span>Contact Person</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('vendor', 'phone')">
                    <span>Phone</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('vendor', 'email')">
                    <span>Email</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="vendorList"></tbody>
            </table>
          </div>
          <div class="audit-log" id="vendorLog">Last action: None</div>
        </section>
        
        <section class="tab hidden" id="employeeTab">
          <div style="margin-bottom:20px;">
            <input oninput="searchEmployees(this.value)" placeholder="üîç Search employees..." style="padding:10px; width:100%; max-width:300px; border-radius:10px; border:1px solid #ccc;" type="text"/>
          </div>
          <h2>Employee Management</h2>
          <div class="form-area">
            <div class="form-row">
              <input id="employeeId" placeholder="Employee ID" type="text"/>
              <input id="employeeName" placeholder="Full Name" type="text"/>
              <input id="employeeDepartment" placeholder="Department" type="text"/>
            </div>
            <div class="form-row">
              <input id="employeePosition" placeholder="Position" type="text"/>
              <input id="employeeEmail" placeholder="Email" type="email"/>
              <input id="employeePhone" placeholder="Phone" type="tel"/>
            </div>
            <button class="btn-primary" onclick="addEmployee()">‚ûï Add Employee</button>
          </div>
          <div class="controls-row">
            <button class="btn-secondary" onclick="downloadCSV(employees, ['id','name','department','position','email','phone'], 'Employee.csv')">‚¨áÔ∏è Download CSV</button>
            <button class="btn-secondary" onclick="exportPDF('employee')">üìÑ Export PDF</button>
            <div class="file-input-wrapper">
              <input accept=".csv" onchange="uploadCSV(event, 'employee')" type="file"/>
              <div class="file-input-label">‚¨ÜÔ∏è Upload CSV</div>
            </div>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th class="sortable" onclick="sortTable('employee', 'id')">
                    <span>Employee ID</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('employee', 'name')">
                    <span>Full Name</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('employee', 'department')">
                    <span>Department</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('employee', 'position')">
                    <span>Position</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('employee', 'email')">
                    <span>Email</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('employee', 'phone')">
                    <span>Phone</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="employeeList"></tbody>
            </table>
          </div>
          <div class="audit-log" id="employeeLog">Last action: None</div>
        </section>
        
        <section class="tab hidden" id="actualTab">
          <h2>Actual Costs</h2>
          <div class="form-area">
            <div class="form-row">
              <div class="form-group" style="grid-column: span 2;">
                <select class="login-input" id="vendor">
                  <option value="">Select Vendor</option>
                </select>
                <button class="btn-secondary" onclick="showVendorQuickAdd()">+ New Vendor</button>
              </div>
              <input id="aProjectNumber" placeholder="Project Number" type="text"/>
              <input id="costType" placeholder="Cost Type" type="text"/>
            </div>
            <div class="form-row">
              <input id="costPrice" placeholder="Cost Price" type="text"/>
              <input id="currency" placeholder="Currency" type="text"/>
            </div>
            <div class="vendor-quick-add" id="vendorQuickAdd">
              <h3>Quick Add Vendor</h3>
              <div class="form-row">
                <input id="quickVendorId" placeholder="Vendor ID" type="text"/>
                <input id="quickVendorName" placeholder="Vendor Name" type="text"/>
              </div>
              <button class="btn-primary" onclick="addQuickVendor()">‚ûï Add Vendor</button>
            </div>
            <button class="btn-primary" onclick="addActual()">‚ûï Add Actual</button>
          </div>
          <div class="controls-row">
            <button class="btn-secondary" onclick="downloadCSV(actuals, ['project','vendor','type','price','currency'], 'Actual.csv')">‚¨áÔ∏è Download CSV</button>
            <button class="btn-secondary" onclick="exportPDF('actual')">üìÑ Export PDF</button>
            <div class="file-input-wrapper">
              <input accept=".csv" onchange="uploadCSV(event, 'actual')" type="file"/>
              <div class="file-input-label">‚¨ÜÔ∏è Upload CSV</div>
            </div>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th class="sortable" onclick="sortTable('actual', 'project')">
                    <span>Project</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('actual', 'vendor')">
                    <span>Vendor</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('actual', 'type')">
                    <span>Cost Type</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('actual', 'price')">
                    <span>Cost Price</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('actual', 'currency')">
                    <span>Currency</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="actualList"></tbody>
            </table>
          </div>
          <div class="audit-log" id="actualLog">Last action: None</div>
        </section>
        
        <section class="tab hidden" id="invoiceTab">
          <h2>Invoice Management</h2>
          <div class="form-area">
            <div class="form-row">
              <input id="invoiceNumber" placeholder="Invoice Number" type="text"/>
              <input id="invoiceProject" placeholder="Project Number" type="text"/>
              <input id="invoiceAmount" placeholder="Amount" type="text"/>
            </div>
            <div class="form-row">
              <input id="invoiceDate" placeholder="Invoice Date" type="date"/>
              <input id="invoiceStatus" placeholder="Status" type="text"/>
              <input id="invoiceDueDate" placeholder="Due Date" type="date"/>
            </div>
            <button class="btn-primary" onclick="addInvoice()">‚ûï Add Invoice</button>
          </div>
          <div class="controls-row">
            <button class="btn-secondary" onclick="downloadCSV(invoices, ['number','project','amount','date','status','dueDate'], 'Invoice.csv')">‚¨áÔ∏è Download CSV</button>
            <button class="btn-secondary" onclick="exportPDF('invoice')">üìÑ Export PDF</button>
            <div class="file-input-wrapper">
              <input accept=".csv" onchange="uploadCSV(event, 'invoice')" type="file"/>
              <div class="file-input-label">‚¨ÜÔ∏è Upload CSV</div>
            </div>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th class="sortable" onclick="sortTable('invoice', 'number')">
                    <span>Invoice Number</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('invoice', 'project')">
                    <span>Project</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('invoice', 'amount')">
                    <span>Amount</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('invoice', 'date')">
                    <span>Invoice Date</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('invoice', 'status')">
                    <span>Status</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th class="sortable" onclick="sortTable('invoice', 'dueDate')">
                    <span>Due Date</span>
                    <span class="sort-indicator">‚ñ≤‚ñº</span>
                  </th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="invoiceList"></tbody>
            </table>
          </div>
          <div class="audit-log" id="invoiceLog">Last action: None</div>
        </section>
        
        <section class="tab hidden" id="dashboardTab">
          <h2>üìä Executive Dashboard</h2>
          <div class="dashboard-grid">
            <div class="dashboard-card">
              <h3>Project Costs</h3>
              <canvas id="projectCostChart"></canvas>
            </div>
            
            <div class="dashboard-card">
              <h3>Invoice Status</h3>
              <canvas id="invoiceStatusChart"></canvas>
            </div>
            
            <div class="dashboard-card">
              <h3>Top Vendors</h3>
              <div id="topVendorsList"></div>
            </div>
            
            <div class="dashboard-card">
              <h3>Approval Workflows</h3>
              <div class="workflow-item">
                <div class="workflow-header">Invoice #RW-2025-002</div>
                <div class="workflow-details">Amount $0.00001 | Project HDR04</div>
                <div class="workflow-details"><b>Docker Account</b></div>
              </div>
              <div class="workflow-item">
                <div class="workflow-header">Project Budget Change</div>
                <div class="workflow-details">Project: ANG07 | Change + SA00</div>
                <div class="workflow-details"><b>Worlds Account</b></div>
              </div>
              <div class="workflow-item">
                <div class="workflow-header">New Vendor Request</div>
                <div class="workflow-details">Vendor New Construction Co. | Category Construction</div>
                <div class="workflow-details"><b>Worlds Account</b></div>
              </div>
              <div class="workflow-item">
                <div class="workflow-header">Expense Report #RDY-2025-045</div>
                <div class="workflow-details">Employee Abundance | Amount $1,025 ($)</div>
              </div>
            </div>
          </div>
        </section>
        
        <section class="tab hidden" id="insightsTab">
          <h2>üß† AI Business Insights</h2>
          <div class="form-area">
            <p style="font-size:16px; font-weight:500; margin-bottom:10px;">Select a metric to analyze:</p>
            <select id="insightSelect" onchange="generateInsight()" style="padding:10px; width:300px; border-radius:10px; border:1px solid #ccc;">
              <option value="">-- Choose Analysis --</option>
              <option value="topCustomer">Top Spending Customer</option>
              <option value="invoiceStatus">Invoice Status Breakdown</option>
              <option value="costliestProject">Costliest Project</option>
              <option value="topVendor">Top Vendor by Spend</option>
              <option value="employeeProductivity">Employee Productivity</option>
            </select>
            <div id="insightResult" style="margin-top:20px; font-size:16px; font-weight:600; color:#333;"></div>
          </div>
          <div class="audit-log">AI insights generated using advanced predictive analytics</div>
        </section>
        
        <section class="tab hidden" id="workflowTab">
          <h2>üìù Workflow Management</h2>
          <div class="form-area">
            <div class="form-row">
              <select id="workflowType" style="padding:10px; width:100%; border-radius:10px; border:1px solid #ccc;">
                <option value="purchase">Purchase Request</option>
                <option value="invoice">Invoice Approval</option>
                <option value="vendor">New Vendor</option>
                <option value="expense">Expense Report</option>
              </select>
              <input id="workflowName" placeholder="Workflow Name" type="text"/>
            </div>
            <div class="form-row">
              <textarea id="workflowSteps" placeholder="Workflow Steps (comma separated)" style="padding:15px; width:100%; height:100px; border-radius:10px; border:1px solid #ccc;"></textarea>
            </div>
            <div class="form-row">
              <input id="workflowCreateDate" type="date" placeholder="Create Date" style="padding:10px; width:100%; border-radius:10px; border:1px solid #ccc;"/>
              <select id="workflowAssigned" style="padding:10px; width:100%; border-radius:10px; border:1px solid #ccc;">
                <option value="">Select Assigned Person</option>
              </select>
            </div>
            <button class="btn-primary" onclick="addWorkflow()">‚ûï Create Workflow</button>
          </div>
          <div class="controls-row">
            <button class="btn-secondary" onclick="downloadCSV(workflows, ['type','name','steps','status','createDate','assigned'], 'Workflows.csv')">‚¨áÔ∏è Download CSV</button>
            <button class="btn-secondary" onclick="exportPDF('workflow')">üìÑ Export PDF</button>
            <div class="file-input-wrapper">
              <input accept=".csv" onchange="uploadCSV(event, 'workflow')" type="file"/>
              <div class="file-input-label">‚¨ÜÔ∏è Upload CSV</div>
            </div>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Workflow Type</th>
                  <th>Name</th>
                  <th>Steps</th>
                  <th>Status</th>
                  <th>Create Date</th>
                  <th>Assigned To</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="workflowList"></tbody>
            </table>
          </div>
          <div class="audit-log" id="workflowLog">Last action: None</div>
        </section>
      </div>
    </main>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
    // Login Functionality
    function login() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      const errorElement = document.getElementById('errorMessage');
      
      // Hardcoded credentials (for demo only)
      const validUsername = 'ssezen';
      const validPassword = '1234';
      
      if (username === validUsername && password === validPassword) {
        // Successful login
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('appContainer').style.display = 'block';
        
        // Initialize the app
        showTab('customer');
        render();
        populateVendorDropdown();
      } else {
        // Failed login
        errorElement.style.display = 'block';
        document.getElementById('password').value = '';
      }
    }

    // Logout Functionality
    function logout() {
      document.getElementById('appContainer').style.display = 'none';
      document.getElementById('loginScreen').style.display = 'flex';
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
      document.getElementById('errorMessage').style.display = 'none';
    }

    // Handle Enter key press in login form
    document.getElementById('password').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        login();
      }
    });

    // Toggle sidebar
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('collapsed');
      
      const collapseBtn = document.getElementById('collapseBtn');
      if (sidebar.classList.contains('collapsed')) {
        collapseBtn.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 4L17 12L9 20" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        `;
      } else {
        collapseBtn.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 4L7 12L15 20" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        `;
      }
    }

    // Main Application Logic
    const tabs = ['dashboard', 'customer', 'project', 'vendor', 'employee', 'actual', 'invoice', 'insights', 'workflow'];
    let currentTab = 'customer';
    
    function showTab(tab) {
      currentTab = tab;
      tabs.forEach(t => {
        document.getElementById(t + 'Tab').classList.add('hidden');
        const btnId = 'btn' + t.charAt(0).toUpperCase() + t.slice(1);
        const btnElement = document.getElementById(btnId);
        if (btnElement) {
          btnElement.classList.remove('active');
        }
      });
      
      document.getElementById(tab + 'Tab').classList.remove('hidden');
      const btnId = 'btn' + tab.charAt(0).toUpperCase() + tab.slice(1);
      const btnElement = document.getElementById(btnId);
      if (btnElement) {
        btnElement.classList.add('active');
      }
      
      updateStats();
      
      if (tab === 'actual') {
        populateVendorDropdown();
      }
      
      if (tab === 'dashboard') {
        setTimeout(renderDashboard, 100);
      }
      
      if (tab === 'insights') {
        document.getElementById('insightSelect').value = '';
        document.getElementById('insightResult').innerHTML = '';
      }
      
      if (tab === 'workflow') {
        populateAssignedDropdown();
      }
    }

    // Initialize with provided data
    let customers = [
      { name: 'The Home Depot', address: '2121 St Clair Ave W, York, ON M6N 5A8', contact: 'David Alaba' },
      { name: 'Apple Inc.', address: '220 Yonge St, Toronto, ON M5B 2H1', contact: 'Steve Jobs' },
      { name: 'Canadian Tire', address: 'Lawrence Square Shopping Centre, 700 Lawrence Ave W, Toronto, ON M6A 3B4', contact: 'Kate Middleton' }
    ];

    let projects = [
      { number: 'AP3941', customer: 'Apple Inc.', date: '2025-08-01' },
      { number: 'HD4054', customer: 'The Home Depot', date: '2025-11-03' },
      { number: 'AP4327', customer: 'Apple Inc.', date: '2026-03-12' },
      { number: 'HD4463', customer: 'The Home Depot', date: '2026-05-27' },
      { number: 'CT4750', customer: 'Canadian Tire', date: '2026-07-15' },
      { number: 'CT4945', customer: 'Canadian Tire', date: '2026-10-23' }
    ];

    // Extract unique vendors from actuals data
    const uniqueVendors = [...new Set([
      'ACCURA GLASS BENDING', 'ADHECO', 'ERIE POWDER COATING', 
      'ADAMS PACKAGING', 'R&R RIVET', 'FASTENAL', 'GRIMCO', 
      'CS2 CONSTRUCTION SALES', 'Hold Tite', 'MONARCH METALS', 
      'MCMASTER CARR', 'CANADIAN TIRE', 'E&J SUPPLY', 
      'KING HOIST & SCAFFOLDING', 'KBC TOOLS', 'CREW CONTRACTING'
    ])];

    let vendors = uniqueVendors.map((name, index) => ({
      id: `V${(index + 1).toString().padStart(3, '0')}`,
      name: name,
      contact: 'Contact ' + (index + 1),
      phone: `+1 (416) 555-${Math.floor(1000 + Math.random() * 9000)}`,
      email: `contact@${name.toLowerCase().replace(/[^a-z0-9]+/g, '')}.com`
    }));

    let actuals = [
      { project: 'AP3941', vendor: 'ACCURA GLASS BENDING', type: 'SERVICES', price: '12450', currency: 'CAD' },
      { project: 'HD4054', vendor: 'ACCURA GLASS BENDING', type: 'PROTOTYPING', price: '8299.99', currency: 'USD' },
      { project: 'AP4327', vendor: 'ADHECO', type: 'HARDWARE', price: '3200', currency: 'USD' },
      { project: 'HD4463', vendor: 'ERIE POWDER COATING', type: 'LOGISTICS', price: '5750.5', currency: 'CAD' },
      { project: 'CT4750', vendor: 'ADAMS PACKAGING', type: 'INSTALLTION', price: '1845.75', currency: 'CAD' },
      { project: 'CT4945', vendor: 'ADAMS PACKAGING', type: 'PROTOTYPING', price: '4300', currency: 'CAD' },
      { project: 'AP3941', vendor: 'R&R RIVET', type: 'METAL', price: '2999.99', currency: 'USD' },
      { project: 'HD4054', vendor: 'FASTENAL', type: 'GLASS', price: '7850.25', currency: 'CAD' },
      { project: 'AP4327', vendor: 'GRIMCO', type: 'GLASS', price: '6425.5', currency: 'CAD' },
      { project: 'HD4463', vendor: 'CS2 CONSTRUCTION SALES', type: 'HARDWARE', price: '11300', currency: 'CAD' },
      { project: 'CT4750', vendor: 'Hold Tite', type: 'FINISHING', price: '9750', currency: 'CAD' },
      { project: 'CT4945', vendor: 'MONARCH METALS', type: 'PACKAGING', price: '3675', currency: 'USD' },
      { project: 'AP3941', vendor: 'MCMASTER CARR', type: 'LOGISTICS', price: '5225.25', currency: 'CAD' },
      { project: 'HD4054', vendor: 'MCMASTER CARR', type: 'LOGISTICS', price: '15000', currency: 'CAD' },
      { project: 'AP4327', vendor: 'CANADIAN TIRE', type: 'SERVICES', price: '2300', currency: 'CAD' },
      { project: 'HD4463', vendor: 'MCMASTER CARR', type: 'PROTOTYPING', price: '4100', currency: 'USD' },
      { project: 'CT4750', vendor: 'MCMASTER CARR', type: 'HARDWARE', price: '18499.99', currency: 'CAD' },
      { project: 'CT4945', vendor: 'E&J SUPPLY', type: 'LOGISTICS', price: '6800', currency: 'CAD' },
      { project: 'AP3941', vendor: 'MCMASTER CARR', type: 'INSTALLTION', price: '22350.5', currency: 'CAD' },
      { project: 'HD4054', vendor: 'ADHECO', type: 'PROTOTYPING', price: '7625', currency: 'CAD' },
      { project: 'AP4327', vendor: 'MCMASTER CARR', type: 'METAL', price: '4975', currency: 'USD' },
      { project: 'HD4463', vendor: 'KING HOIST & SCAFFOLDING', type: 'GLASS', price: '10250', currency: 'CAD' },
      { project: 'CT4750', vendor: 'KBC TOOLS', type: 'INSTALLTION', price: '3450', currency: 'CAD' },
      { project: 'CT4945', vendor: 'KBC TOOLS', type: 'HARDWARE', price: '13500', currency: 'CAD' },
      { project: 'AP3941', vendor: 'CREW CONTRACTING', type: 'FINISHING', price: '1299.99', currency: 'CAD' },
      { project: 'HD4054', vendor: 'MCMASTER CARR', type: 'PACKAGING', price: '5750', currency: 'USD' },
      { project: 'AP4327', vendor: 'KBC TOOLS', type: 'LOGISTICS', price: '16200', currency: 'CAD' },
      { project: 'HD4463', vendor: 'KBC TOOLS', type: 'LOGISTICS', price: '8900', currency: 'CAD' },
      { project: 'CT4750', vendor: 'MCMASTER CARR', type: 'HARDWARE', price: '3750', currency: 'USD' },
      { project: 'CT4945', vendor: 'MCMASTER CARR', type: 'HARDWARE', price: '2450', currency: 'CAD' }
    ];

    let employees = [
      { id: 'E001', name: 'Alex Johnson', department: 'Development', position: 'Senior Developer', email: 'alex.johnson@example.com', phone: '+1 (416) 555-1234' },
      { id: 'E002', name: 'Maria Garcia', department: 'Sales', position: 'Sales Manager', email: 'maria.garcia@example.com', phone: '+1 (416) 555-5678' },
      { id: 'E003', name: 'David Brown', department: 'Finance', position: 'Financial Analyst', email: 'david.brown@example.com', phone: '+1 (416) 555-9012' },
      { id: 'E004', name: 'Sarah Miller', department: 'HR', position: 'HR Specialist', email: 'sarah.miller@example.com', phone: '+1 (416) 555-3456' },
      { id: 'E005', name: 'James Wilson', department: 'Operations', position: 'Operations Manager', email: 'james.wilson@example.com', phone: '+1 (416) 555-7890' }
    ];

    let invoices = [
      { number: 'INV-2025-001', project: 'AP3941', amount: '12450.00', date: '2025-08-05', status: 'Paid', dueDate: '2025-09-05' },
      { number: 'INV-2025-002', project: 'HD4054', amount: '8299.99', date: '2025-11-10', status: 'Pending', dueDate: '2025-12-10' },
      { number: 'INV-2026-001', project: 'AP4327', amount: '3200.00', date: '2026-03-15', status: 'Pending', dueDate: '2026-04-15' },
      { number: 'INV-2026-002', project: 'HD4463', amount: '5750.50', date: '2026-06-01', status: 'Overdue', dueDate: '2026-07-01' },
      { number: 'INV-2026-003', project: 'CT4750', amount: '1845.75', date: '2026-07-20', status: 'Paid', dueDate: '2026-08-20' }
    ];

    let workflows = [
      { 
        type: 'purchase request', 
        name: 'Purchase Request Workflow', 
        steps: 'Submit, Manager Approval, Finance Review', 
        status: 'Active',
        createDate: '2025-01-15',
        assigned: 'Alex Johnson'
      },
      { 
        type: 'Invoice approval', 
        name: 'Standard Invoice Approval', 
        steps: 'Submit, Accounts Payable, Manager Approval', 
        status: 'Active',
        createDate: '2025-02-20',
        assigned: 'Maria Garcia'
      }
    ];

    // Sorting state for each table
    const sortState = {
      customer: { field: null, direction: 'asc' },
      project: { field: null, direction: 'asc' },
      vendor: { field: null, direction: 'asc' },
      actual: { field: null, direction: 'asc' },
      employee: { field: null, direction: 'asc' },
      invoice: { field: null, direction: 'asc' }
    };

    // Sorting functionality
    function sortTable(type, field) {
      const currentState = sortState[type];
      
      // Toggle direction if same field clicked
      if (currentState.field === field) {
        currentState.direction = currentState.direction === 'asc' ? 'desc' : 'asc';
      } else {
        currentState.field = field;
        currentState.direction = 'asc';
      }
      
      // Sort the data
      let data;
      if (type === 'customer') data = customers;
      if (type === 'project') data = projects;
      if (type === 'vendor') data = vendors;
      if (type === 'actual') data = actuals;
      if (type === 'employee') data = employees;
      if (type === 'invoice') data = invoices;
      
      data.sort((a, b) => {
        let valA = a[field] || '';
        let valB = b[field] || '';
        
        // Numeric sorting for price/amount fields
        if (field === 'price' || field === 'amount') {
          valA = parseFloat(valA) || 0;
          valB = parseFloat(valB) || 0;
          return currentState.direction === 'asc' ? valA - valB : valB - valA;
        }
        
        // Date sorting for date fields
        if (field === 'date' || field === 'dueDate') {
          valA = new Date(valA);
          valB = new Date(valB);
          return currentState.direction === 'asc' ? valA - valB : valB - valA;
        }
        
        // Default string sorting
        valA = String(valA).toLowerCase();
        valB = String(valB).toLowerCase();
        if (valA < valB) return currentState.direction === 'asc' ? -1 : 1;
        if (valA > valB) return currentState.direction === 'asc' ? 1 : -1;
        return 0;
      });
      
      render();
    }

    function updateStats() {
      let count = 0;
      let label = '';
      
      switch(currentTab) {
        case 'customer':
          count = customers.length;
          label = 'Total Customer Records';
          break;
        case 'project':
          count = projects.length;
          label = 'Total Project Records';
          break;
        case 'vendor':
          count = vendors.length;
          label = 'Total Vendor Records';
          break;
        case 'actual':
          count = actuals.length;
          label = 'Total Actual Records';
          break;
        case 'employee':
          count = employees.length;
          label = 'Total Employee Records';
          break;
        case 'invoice':
          count = invoices.length;
          label = 'Total Invoice Records';
          break;
        case 'dashboard':
          count = projects.length;
          label = 'Projects Overview';
          break;
        case 'insights':
          count = customers.length + projects.length;
          label = 'Business Insights';
          break;
        case 'workflow':
          count = workflows.length;
          label = 'Workflows';
          break;
      }
      
      document.getElementById('totalRecords').textContent = count;
      document.getElementById('recordsLabel').textContent = label;
    }

    function render() {
      renderTable(customers, 'customerList', ['name','address','contact'], 'customer');
      renderTable(projects, 'projectList', ['number','customer','date'], 'project');
      renderTable(vendors, 'vendorList', ['id','name','contact','phone','email'], 'vendor');
      renderTable(actuals, 'actualList', ['project','vendor','type','price','currency'], 'actual');
      renderTable(employees, 'employeeList', ['id','name','department','position','email','phone'], 'employee');
      renderTable(invoices, 'invoiceList', ['number','project','amount','date','status','dueDate'], 'invoice');
      renderTable(workflows, 'workflowList', ['type','name','steps','status','createDate','assigned'], 'workflow');
      updateStats();
    }

    function renderTable(data, id, fields, type) {
      const tbody = document.getElementById(id);
      tbody.innerHTML = '';
      data.forEach((item, idx) => {
        const row = document.createElement('tr');
        
        // Add data cells first
        fields.forEach(f => {
          const td = document.createElement('td');
          td.textContent = item[f] || '';
          row.appendChild(td);
        });
        
        // Add action cell last (rightmost)
        const actionCell = document.createElement('td');
        actionCell.innerHTML = `<button class='action-btn edit-btn' onclick='editEntry(${idx}, "${type}")'>‚úèÔ∏è Edit</button>
                                <span class='action-divider'>|</span>
                                <button class='action-btn delete-btn' onclick='deleteEntry(${idx}, "${type}")'>üóëÔ∏è Delete</button>`;
        row.appendChild(actionCell);
        
        tbody.appendChild(row);
      });
    }

    function deleteEntry(index, type) {
      if (confirm('Are you sure you want to delete this record?')) {
        let message = '';
        if (type === 'customer') {
          const name = customers[index].name;
          customers.splice(index, 1);
          message = `Deleted customer: ${name}`;
        }
        if (type === 'project') {
          const number = projects[index].number;
          projects.splice(index, 1);
          message = `Deleted project: ${number}`;
        }
        if (type === 'vendor') {
          const name = vendors[index].name;
          vendors.splice(index, 1);
          message = `Deleted vendor: ${name}`;
        }
        if (type === 'actual') {
          const project = actuals[index].project;
          actuals.splice(index, 1);
          message = `Deleted actual cost for project: ${project}`;
        }
        if (type === 'employee') {
          const name = employees[index].name;
          employees.splice(index, 1);
          message = `Deleted employee: ${name}`;
        }
        if (type === 'invoice') {
          const number = invoices[index].number;
          invoices.splice(index, 1);
          message = `Deleted invoice: ${number}`;
        }
        if (type === 'workflow') {
          const name = workflows[index].name;
          workflows.splice(index, 1);
          message = `Deleted workflow: ${name}`;
        }
        
        updateLog(type, message);
        render();
      }
    }

    function editEntry(index, type) {
      let item;
      let message = '';
      if (type === 'customer') {
        item = customers[index];
        document.getElementById('customerName').value = item.name || '';
        document.getElementById('address').value = item.address || '';
        document.getElementById('contactPerson').value = item.contact || '';
        customers.splice(index, 1);
        message = `Editing customer: ${item.name}`;
        showTab('customer');
      } else if (type === 'project') {
        item = projects[index];
        document.getElementById('projectNumber').value = item.number || '';
        document.getElementById('customerNo').value = item.customer || '';
        document.getElementById('startDate').value = item.date || '';
        projects.splice(index, 1);
        message = `Editing project: ${item.number}`;
        showTab('project');
      } else if (type === 'vendor') {
        item = vendors[index];
        document.getElementById('vendorId').value = item.id || '';
        document.getElementById('vendorName').value = item.name || '';
        document.getElementById('vendorContact').value = item.contact || '';
        document.getElementById('vendorPhone').value = item.phone || '';
        document.getElementById('vendorEmail').value = item.email || '';
        vendors.splice(index, 1);
        message = `Editing vendor: ${item.name}`;
        showTab('vendor');
      } else if (type === 'actual') {
        item = actuals[index];
        document.getElementById('aProjectNumber').value = item.project || '';
        document.getElementById('vendor').value = item.vendor || '';
        document.getElementById('costType').value = item.type || '';
        document.getElementById('costPrice').value = item.price || '';
        document.getElementById('currency').value = item.currency || '';
        actuals.splice(index, 1);
        message = `Editing actual cost for project: ${item.project}`;
        showTab('actual');
      } else if (type === 'employee') {
        item = employees[index];
        document.getElementById('employeeId').value = item.id || '';
        document.getElementById('employeeName').value = item.name || '';
        document.getElementById('employeeDepartment').value = item.department || '';
        document.getElementById('employeePosition').value = item.position || '';
        document.getElementById('employeeEmail').value = item.email || '';
        document.getElementById('employeePhone').value = item.phone || '';
        employees.splice(index, 1);
        message = `Editing employee: ${item.name}`;
        showTab('employee');
      } else if (type === 'invoice') {
        item = invoices[index];
        document.getElementById('invoiceNumber').value = item.number || '';
        document.getElementById('invoiceProject').value = item.project || '';
        document.getElementById('invoiceAmount').value = item.amount || '';
        document.getElementById('invoiceDate').value = item.date || '';
        document.getElementById('invoiceStatus').value = item.status || '';
        document.getElementById('invoiceDueDate').value = item.dueDate || '';
        invoices.splice(index, 1);
        message = `Editing invoice: ${item.number}`;
        showTab('invoice');
      } else if (type === 'workflow') {
        item = workflows[index];
        document.getElementById('workflowType').value = item.type || '';
        document.getElementById('workflowName').value = item.name || '';
        document.getElementById('workflowSteps').value = item.steps || '';
        document.getElementById('workflowCreateDate').value = item.createDate || '';
        document.getElementById('workflowAssigned').value = item.assigned || '';
        workflows.splice(index, 1);
        message = `Editing workflow: ${item.name}`;
        showTab('workflow');
      }
      
      updateLog(type, message);
      render();
    }

    function updateLog(type, message) {
      const logElement = document.getElementById(type + 'Log');
      if (logElement) {
        logElement.textContent = `Last action: ${message}`;
      }
    }

    function addCustomer() {
      const name = document.getElementById('customerName').value.trim();
      const address = document.getElementById('address').value.trim();
      const contact = document.getElementById('contactPerson').value.trim();
      
      if (!name) {
        alert('Please enter a customer name');
        return;
      }
      
      customers.push({ name, address, contact });
      updateLog('customer', `Added customer: ${name}`);
      document.getElementById('customerName').value = '';
      document.getElementById('address').value = '';
      document.getElementById('contactPerson').value = '';
      render();
    }

    function addProject() {
      const number = document.getElementById('projectNumber').value.trim();
      const customer = document.getElementById('customerNo').value.trim();
      const date = document.getElementById('startDate').value;
      
      if (!number) {
        alert('Please enter a project number');
        return;
      }
      
      projects.push({ number, customer, date });
      updateLog('project', `Added project: ${number}`);
      document.getElementById('projectNumber').value = '';
      document.getElementById('customerNo').value = '';
      document.getElementById('startDate').value = '';
      render();
    }

    function addVendor() {
      const id = document.getElementById('vendorId').value.trim();
      const name = document.getElementById('vendorName').value.trim();
      const contact = document.getElementById('vendorContact').value.trim();
      const phone = document.getElementById('vendorPhone').value.trim();
      const email = document.getElementById('vendorEmail').value.trim();
      
      if (!id || !name) {
        alert('Please enter Vendor ID and Name');
        return;
      }
      
      vendors.push({ id, name, contact, phone, email });
      updateLog('vendor', `Added vendor: ${name}`);
      document.getElementById('vendorId').value = '';
      document.getElementById('vendorName').value = '';
      document.getElementById('vendorContact').value = '';
      document.getElementById('vendorPhone').value = '';
      document.getElementById('vendorEmail').value = '';
      render();
      populateVendorDropdown();
    }

    function populateVendorDropdown() {
      const vendorSelect = document.getElementById('vendor');
      vendorSelect.innerHTML = '<option value="">Select Vendor</option>';
      
      vendors.forEach(vendor => {
        const option = document.createElement('option');
        option.value = vendor.name;
        option.textContent = vendor.name;
        vendorSelect.appendChild(option);
      });
    }

    function showVendorQuickAdd() {
      const quickAdd = document.getElementById('vendorQuickAdd');
      quickAdd.style.display = 'block';
    }

    function addQuickVendor() {
      const id = document.getElementById('quickVendorId').value.trim();
      const name = document.getElementById('quickVendorName').value.trim();
      
      if (!id || !name) {
        alert('Please enter Vendor ID and Name');
        return;
      }
      
      vendors.push({ id, name, contact: 'New Contact', phone: '', email: '' });
      updateLog('vendor', `Added vendor: ${name}`);
      document.getElementById('quickVendorId').value = '';
      document.getElementById('quickVendorName').value = '';
      document.getElementById('vendorQuickAdd').style.display = 'none';
      
      render();
      populateVendorDropdown();
      document.getElementById('vendor').value = name;
    }

    function addActual() {
      const project = document.getElementById('aProjectNumber').value.trim();
      const vendor = document.getElementById('vendor').value;
      const type = document.getElementById('costType').value.trim();
      const price = document.getElementById('costPrice').value.trim();
      const currency = document.getElementById('currency').value.trim();
      
      if (!project || !vendor) {
        alert('Please enter a project number and select a vendor');
        return;
      }
      
      actuals.push({ project, vendor, type, price, currency });
      updateLog('actual', `Added actual cost for project: ${project}`);
      document.getElementById('aProjectNumber').value = '';
      document.getElementById('vendor').value = '';
      document.getElementById('costType').value = '';
      document.getElementById('costPrice').value = '';
      document.getElementById('currency').value = '';
      render();
    }

    function addEmployee() {
      const id = document.getElementById('employeeId').value.trim();
      const name = document.getElementById('employeeName').value.trim();
      const department = document.getElementById('employeeDepartment').value.trim();
      const position = document.getElementById('employeePosition').value.trim();
      const email = document.getElementById('employeeEmail').value.trim();
      const phone = document.getElementById('employeePhone').value.trim();
      
      if (!id || !name) {
        alert('Please enter Employee ID and Name');
        return;
      }
      
      employees.push({ id, name, department, position, email, phone });
      updateLog('employee', `Added employee: ${name}`);
      document.getElementById('employeeId').value = '';
      document.getElementById('employeeName').value = '';
      document.getElementById('employeeDepartment').value = '';
      document.getElementById('employeePosition').value = '';
      document.getElementById('employeeEmail').value = '';
      document.getElementById('employeePhone').value = '';
      render();
    }

    function addInvoice() {
      const number = document.getElementById('invoiceNumber').value.trim();
      const project = document.getElementById('invoiceProject').value.trim();
      const amount = document.getElementById('invoiceAmount').value.trim();
      const date = document.getElementById('invoiceDate').value;
      const status = document.getElementById('invoiceStatus').value.trim();
      const dueDate = document.getElementById('invoiceDueDate').value;
      
      if (!number || !project || !amount) {
        alert('Please enter Invoice Number, Project, and Amount');
        return;
      }
      
      invoices.push({ number, project, amount, date, status, dueDate });
      updateLog('invoice', `Added invoice: ${number}`);
      document.getElementById('invoiceNumber').value = '';
      document.getElementById('invoiceProject').value = '';
      document.getElementById('invoiceAmount').value = '';
      document.getElementById('invoiceDate').value = '';
      document.getElementById('invoiceStatus').value = '';
      document.getElementById('invoiceDueDate').value = '';
      render();
    }
    
    function addWorkflow() {
      const type = document.getElementById('workflowType').value;
      const name = document.getElementById('workflowName').value.trim();
      const steps = document.getElementById('workflowSteps').value.trim();
      const createDate = document.getElementById('workflowCreateDate').value;
      const assigned = document.getElementById('workflowAssigned').value;
      
      if (!name || !steps) {
        alert('Please enter Workflow Name and Steps');
        return;
      }
      
      workflows.push({ 
        type, 
        name, 
        steps, 
        status: 'Active',
        createDate,
        assigned 
      });
      updateLog('workflow', `Added workflow: ${name}`);
      document.getElementById('workflowName').value = '';
      document.getElementById('workflowSteps').value = '';
      document.getElementById('workflowCreateDate').value = '';
      document.getElementById('workflowAssigned').value = '';
      render();
    }
    
    function populateAssignedDropdown() {
      const assignedSelect = document.getElementById('workflowAssigned');
      assignedSelect.innerHTML = '<option value="">Select Assigned Person</option>';
      employees.forEach(emp => {
        const option = document.createElement('option');
        option.value = emp.name;
        option.textContent = emp.name;
        assignedSelect.appendChild(option);
      });
    }

    function downloadCSV(data, columns, filename) {
      if (data.length === 0) {
        alert('No data to download');
        return;
      }
      
      const csv = [columns.join(',')].concat(
        data.map(row => columns.map(col => JSON.stringify(row[col] || '')).join(','))
      ).join('\n');
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
      
      // Update log
      updateLog(currentTab, `Exported CSV: ${filename}`);
    }
    
    function exportPDF(type) {
      // Get the table container
      const element = document.querySelector(`#${type}Tab .table-container`);
      
      // Use html2canvas to create a canvas from the table
      html2canvas(element).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
        const imgProps = pdf.getImageProperties(imgData);
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        
        pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
        pdf.save(`${type}-data.pdf`);
        
        // Update log
        updateLog(type, `Exported PDF: ${type}-data.pdf`);
      });
    }

    function uploadCSV(event, type) {
      const file = event.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const lines = e.target.result.split('\n').filter(l => l.trim());
          if (lines.length < 2) {
            alert('CSV file must contain headers and at least one data row');
            return;
          }
          
          const headers = lines[0].split(',').map(h => h.replace(/\r/g,'').replace(/"/g,'').trim());
          const records = lines.slice(1).map(line => {
            const values = line.split(',');
            const obj = {};
            headers.forEach((h, i) => {
              obj[h] = values[i] ? values[i].replace(/\r/g,'').replace(/"/g,'').trim() : '';
            });
            return obj;
          }).filter(record => Object.values(record).some(v => v.trim()));
          
          if (type === 'customer') customers = records;
          if (type === 'project') projects = records;
          if (type === 'vendor') vendors = records;
          if (type === 'actual') actuals = records;
          if (type === 'employee') employees = records;
          if (type === 'invoice') invoices = records;
          if (type === 'workflow') workflows = records;
          
          updateLog(type, `Imported ${records.length} records from CSV`);
          render();
          alert(`Successfully imported ${records.length} records`);
        } catch (error) {
          alert('Error reading CSV file. Please check the format.');
        }
      };
      reader.readAsText(file);
      event.target.value = ''; // Reset file input
    }
    
    // === Dark Mode Toggle ===
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
    }
    
    function generateInsight() {
      const type = document.getElementById('insightSelect').value;
      let result = '';

      if (type === 'topCustomer') {
        const totals = {};
        actuals.forEach(({ project, price }) => {
          const proj = projects.find(p => p.number === project);
          if (proj) {
            const cust = proj.customer;
            totals[cust] = (totals[cust] || 0) + parseFloat(price);
          }
        });
        const top = Object.entries(totals).sort((a, b) => b[1] - a[1])[0];
        result = `üèÜ Top Customer: <b>${top[0]}</b> ‚Üí Total Spend: <b>$${top[1].toFixed(2)}</b>`;
      }
      else if (type === 'invoiceStatus') {
        const counts = {};
        invoices.forEach(inv => {
          const status = inv.status || 'Unknown';
          counts[status] = (counts[status] || 0) + 1;
        });
        result = 'üìä Invoice Status:<ul>' + Object.entries(counts).map(([s,c]) => `<li>${s}: <b>${c}</b></li>`).join('') + '</ul>';
      }
      else if (type === 'costliestProject') {
        const totals = {};
        actuals.forEach(({ project, price }) => {
          totals[project] = (totals[project] || 0) + parseFloat(price);
        });
        const top = Object.entries(totals).sort((a, b) => b[1] - a[1])[0];
        result = `üí∞ Most Expensive Project: <b>${top[0]}</b> ‚Üí Total Cost: <b>$${top[1].toFixed(2)}</b>`;
      }
      else if (type === 'topVendor') {
        const totals = {};
        actuals.forEach(({ vendor, price }) => {
          totals[vendor] = (totals[vendor] || 0) + parseFloat(price);
        });
        const top = Object.entries(totals).sort((a, b) => b[1] - a[1])[0];
        result = `üèÜ Top Vendor: <b>${top[0]}</b> ‚Üí Total Spend: <b>$${top[1].toFixed(2)}</b>`;
      }
      else if (type === 'employeeProductivity') {
        const projectCount = {};
        projects.forEach(project => {
          const projNum = project.number;
          projectCount[projNum] = actuals.filter(a => a.project === projNum).length;
        });
        
        const topProject = Object.entries(projectCount).sort((a, b) => b[1] - a[1])[0];
        result = `üöÄ Most Active Project: <b>${topProject[0]}</b> ‚Üí Activities: <b>${topProject[1]}</b>`;
      }

      document.getElementById('insightResult').innerHTML = result;
      updateLog('insights', `Generated insight: ${type.replace(/([A-Z])/g, ' $1').trim()}`);
    }
    
    // Search functions
    function searchCustomers(value) {
      const lower = value.toLowerCase();
      const filtered = customers.filter(c => 
        c.name.toLowerCase().includes(lower) || 
        c.address.toLowerCase().includes(lower) || 
        c.contact.toLowerCase().includes(lower)
      );
      renderTable(filtered, 'customerList', ['name','address','contact'], 'customer');
    }
    
    function searchProjects(value) {
      const lower = value.toLowerCase();
      const filtered = projects.filter(p => 
        p.number.toLowerCase().includes(lower) || 
        p.customer.toLowerCase().includes(lower) || 
        p.date.toLowerCase().includes(lower)
      );
      renderTable(filtered, 'projectList', ['number','customer','date'], 'project');
    }
    
    function searchVendors(value) {
      const lower = value.toLowerCase();
      const filtered = vendors.filter(v => 
        v.id.toLowerCase().includes(lower) || 
        v.name.toLowerCase().includes(lower) || 
        v.contact.toLowerCase().includes(lower) || 
        v.phone.toLowerCase().includes(lower) || 
        v.email.toLowerCase().includes(lower)
      );
      renderTable(filtered, 'vendorList', ['id','name','contact','phone','email'], 'vendor');
    }
    
    function searchEmployees(value) {
      const lower = value.toLowerCase();
      const filtered = employees.filter(e => 
        e.id.toLowerCase().includes(lower) || 
        e.name.toLowerCase().includes(lower) || 
        e.department.toLowerCase().includes(lower) || 
        e.position.toLowerCase().includes(lower) || 
        e.email.toLowerCase().includes(lower) || 
        e.phone.toLowerCase().includes(lower)
      );
      renderTable(filtered, 'employeeList', ['id','name','department','position','email','phone'], 'employee');
    }
    
    // === Chart Dashboard ===
    function renderDashboard() {
      // Project Costs Chart
      const projTotals = {};
      actuals.forEach(({ project, price }) => {
        projTotals[project] = (projTotals[project] || 0) + parseFloat(price);
      });
      const projLabels = Object.keys(projTotals);
      const projData = Object.values(projTotals);
      
      const projectCostCanvas = document.getElementById('projectCostChart');
      if (projectCostCanvas) {
        new Chart(projectCostCanvas, {
          type: 'bar',
          data: {
            labels: projLabels,
            datasets: [{
              label: 'Project Costs',
              data: projData,
              backgroundColor: 'rgba(102, 126, 234, 0.6)'
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              title: { display: true, text: 'Total Cost per Project' }
            }
          }
        });
      }

      // Invoice Status Pie Chart
      const statusCount = {};
      invoices.forEach(inv => {
        const s = inv.status || 'Unknown';
        statusCount[s] = (statusCount[s] || 0) + 1;
      });
      
      const invoiceStatusCanvas = document.getElementById('invoiceStatusChart');
      if (invoiceStatusCanvas) {
        new Chart(invoiceStatusCanvas, {
          type: 'doughnut',
          data: {
            labels: Object.keys(statusCount),
            datasets: [{
              label: 'Invoices',
              data: Object.values(statusCount),
              backgroundColor: ['#667eea','#764ba2','#e74c3c','#f39c12','#1abc9c']
            }]
          },
          options: {
            responsive: true,
            plugins: {
              title: { display: true, text: 'Invoice Status Distribution' }
            }
          }
        });
      }
      
      // Top Vendors
      const vendorTotals = {};
      actuals.forEach(({ vendor, price }) => {
        vendorTotals[vendor] = (vendorTotals[vendor] || 0) + parseFloat(price);
      });
      const topVendors = Object.entries(vendorTotals)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
      
      const topVendorsList = document.getElementById('topVendorsList');
      if (topVendorsList) {
        topVendorsList.innerHTML = '<ul style="padding-left:20px;">' + 
          topVendors.map(([v, total]) => 
            `<li><b>${v}</b>: $${total.toFixed(2)}</li>`
          ).join('') + '</ul>';
      }
    }
    
    // Initialize
    window.addEventListener('DOMContentLoaded', function() {
      if (document.getElementById('appContainer').style.display === 'block') {
        render();
        populateVendorDropdown();
      }
    });
  </script>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
>>>>>>> 58a4d45ea4609e3bd1b04a4e6c8fb21fff907291
